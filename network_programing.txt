See the following man pages:

tcp
getsockopt
getprotoent
socket

